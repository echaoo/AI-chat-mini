# 其他功能文档

## 一、概述
本文档记录除核心聊天功能外的辅助功能和特色功能，包括情感陪伴、生活助手等。

---

## 二、情感陪伴功能

### 2.1 哄睡功能
**入口**：首页 - 哄睡按钮

#### 产品定位
为失眠或需要陪伴入睡的用户提供温馨的睡前陪伴。

#### 功能设计（待开发）
1. **睡前故事**
   - AI 生成睡前故事
   - 支持故事类型选择（童话、科幻、治愈系等）
   - 舒缓的叙述节奏

2. **放松引导**
   - 呼吸练习引导
   - 冥想引导语
   - 渐进式肌肉放松

3. **白噪音/轻音乐**
   - 雨声、海浪声、森林声等
   - 轻柔的背景音乐
   - 支持定时关闭

4. **聊天陪伴**
   - 专门的哄睡对话模式
   - 温柔、舒缓的回复风格
   - 避免兴奋性话题

5. **睡眠记录**
   - 记录入睡时间
   - 统计使用频率
   - 生成睡眠报告

#### 技术实现思路
- 创建专门的哄睡角色或模式
- 调整 AI 的 system prompt（温柔、舒缓风格）
- 集成音频播放功能
- 使用计时器实现定时功能
- LocalStorage 存储睡眠记录

#### 数据存储
```typescript
interface SleepRecord {
  date: string              // 日期
  startTime: string         // 开始时间
  duration: number          // 持续时长（分钟）
  mode: 'story' | 'chat' | 'music'  // 使用模式
}
```

---

### 2.2 陪我一起功能
**入口**：首页 - 陪我一起按钮

#### 产品定位
为用户在各种生活场景中提供虚拟陪伴，减少孤独感。

#### 功能设计（待开发）
1. **场景选择**
   - 学习陪伴（专注监督、知识问答）
   - 运动陪伴（跑步、健身打卡）
   - 做饭陪伴（菜谱推荐、烹饪指导）
   - 看电影陪伴（影评讨论、剧情分析）
   - 散步陪伴（闲聊、心情疏导）

2. **实时互动**
   - 定时提醒和鼓励
   - 根据场景调整对话风格
   - 支持语音互动

3. **打卡记录**
   - 每日陪伴时长统计
   - 完成场景打卡
   - 成就系统

4. **情绪支持**
   - 识别用户情绪状态
   - 提供适当的安慰和鼓励
   - 庆祝用户的小成就

#### 场景模式配置
```typescript
interface CompanionMode {
  id: string
  name: string              // 场景名称
  icon: string              // 图标
  systemPrompt: string      // 场景专属 prompt
  duration: number          // 建议时长（分钟）
  reminders: string[]       // 提醒语句
}
```

#### 技术实现思路
- 为不同场景设计专门的 system prompt
- 使用计时器定时发送鼓励消息
- LocalStorage 记录打卡数据
- 考虑接入步数、运动数据等

---

## 三、生活助手功能

### 3.1 记住功能
**定位**：AI 角色能够记住用户的重要信息，提供个性化服务。

#### 功能模块（待开发）

##### 3.1.1 纪念日管理
1. **添加纪念日**
   - 生日、恋爱纪念日、结婚纪念日
   - 自定义纪念日
   - 支持农历日期

2. **提醒机制**
   - 提前 N 天提醒
   - 当天特别问候
   - 周年祝福

3. **智能对话**
   - AI 主动提起纪念日
   - 推荐庆祝方式
   - 生成祝福语

##### 3.1.2 经期管理
1. **周期记录**
   - 记录经期开始/结束日期
   - 预测下次经期
   - 周期规律分析

2. **贴心提醒**
   - 经期前提醒准备
   - 经期中关怀问候
   - 饮食、运动建议

3. **情绪关怀**
   - 识别经期情绪波动
   - 提供情绪疏导
   - 舒缓建议

##### 3.1.3 日程管理
1. **日程添加**
   - 自然语言识别日程
   - 设置日程时间、地点、备注
   - 支持重复日程

2. **日程提醒**
   - 提前提醒
   - 当天提醒
   - 过期提醒

3. **智能助手**
   - AI 主动询问日程进展
   - 冲突检测
   - 行程建议

##### 3.1.4 喜好记忆
1. **自动记忆**
   - 从对话中提取用户喜好
   - 记住用户偏好（食物、电影、音乐等）
   - 记住用户重要关系（家人、朋友名字）

2. **应用场景**
   - 推荐时考虑用户喜好
   - 个性化问候
   - 话题延续

#### 数据模型
```typescript
// 纪念日
interface Anniversary {
  id: string
  name: string              // 纪念日名称
  date: string              // 日期（MM-DD）
  type: 'birthday' | 'anniversary' | 'custom'
  isLunar: boolean          // 是否农历
  reminderDays: number[]    // 提前提醒天数
  createdAt: string
}

// 经期记录
interface PeriodRecord {
  id: string
  startDate: string         // 开始日期
  endDate: string           // 结束日期
  cycle: number             // 周期天数（自动计算）
  createdAt: string
}

// 日程
interface Schedule {
  id: string
  title: string             // 日程标题
  datetime: string          // 日期时间
  location?: string         // 地点
  note?: string             // 备注
  reminderMinutes: number   // 提前提醒分钟数
  isCompleted: boolean      // 是否完成
  repeatType?: 'daily' | 'weekly' | 'monthly'  // 重复类型
  createdAt: string
}

// 用户喜好
interface UserPreference {
  category: string          // 分类（食物、电影、音乐等）
  items: Array<{
    name: string
    preference: 'like' | 'dislike'
    mentionedAt: string
  }>
}

// 重要人物
interface ImportantPerson {
  name: string
  relationship: string      // 关系（妈妈、朋友等）
  birthday?: string
  note?: string
  mentionedAt: string
}
```

#### 技术实现思路
1. **数据存储**
   - LocalStorage 存储基础数据
   - 考虑云端同步（后期）

2. **AI 记忆增强**
   - 将记忆数据注入对话上下文
   - 定期总结和提取关键信息
   - 使用 RAG（检索增强生成）技术

3. **提醒系统**
   - 后台定时任务检查提醒
   - 微信模板消息推送
   - 首页智能提示

4. **自然语言处理**
   - 时间识别（"下周三"、"明天下午 3 点"）
   - 意图识别（添加日程、查询经期等）
   - 实体抽取（人名、地点等）

---

## 四、用户系统功能（待开发）

### 4.1 积分系统
- 每日登录奖励
- 聊天消耗积分
- 积分商城兑换

### 4.2 会员系统
- 免费会员限制
- 付费会员权益
- 会员专属角色

### 4.3 个人中心
- 个人信息编辑
- 偏好设置
- 数据统计（聊天时长、消息数等）

---

## 五、社交功能（待规划）

### 5.1 角色分享
- 分享自定义角色给好友
- 角色社区评论点赞

### 5.2 对话分享
- 精彩对话截图分享
- 隐私保护设置

---

## 六、开发优先级

### P0（核心必做）
- [ ] 基础聊天功能（已完成）
- [ ] 角色选择和管理（已完成）

### P1（重要）
- [ ] 纪念日管理
- [ ] 日程管理
- [ ] 哄睡功能（基础版）

### P2（优化体验）
- [ ] 经期管理
- [ ] 陪我一起功能
- [ ] 用户喜好记忆

### P3（增值服务）
- [ ] 积分/会员系统
- [ ] 社交分享功能
- [ ] 高级哄睡功能（音频）

---

## 七、相关文件
**待创建**
- `src/pages/sleep-companion.mpx` - 哄睡功能页
- `src/pages/together.mpx` - 陪我一起页
- `src/pages/memory.mpx` - 记住功能管理页
- `src/pages/anniversaries.mpx` - 纪念日列表页
- `src/pages/schedules.mpx` - 日程列表页

**API 待扩展**
- `/companion/anniversaries` - 纪念日相关接口
- `/companion/periods` - 经期记录接口
- `/companion/schedules` - 日程管理接口
- `/companion/preferences` - 用户喜好接口

---

**最后更新**：2025-12-25
